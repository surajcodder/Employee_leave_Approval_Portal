sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("project1.controller.LeaveReqDetailed",{onInit:function(){debugger;const e=this.getOwnerComponent().getRouter();e.getRoute("LeaveReqDetailed").attachPatternMatched(this._onLeaveReqMatched,this);this.getView().setModel(new t({comment:""}),"commentModel");this.getView().setModel(new t,"context");this.getView().setModel(new t({items:[]}),"documents")},_onLeaveReqMatched:function(e){debugger;const t=e.getParameter("arguments").ID;if(!t){console.error("No ID passed to route.");return}const o=this.getView();const n=o.getModel();const s=`/LeaveRequest(ID='${t}',IsActiveEntity=true)`;o.bindElement({path:s,parameters:{},events:{dataReceived:function(e){const o=e.getParameter("data");debugger;if(!o){console.error("Leave request not found for ID:",t)}}}});const c=`${s}/files`;const a=n.bindList(c);a.requestContexts().then(function(e){debugger;const t=e.map(e=>e.getObject());o.getModel("documents").setProperty("/items",t)}).catch(function(e){console.error("Failed to load attachments:",e);sap.m.MessageToast.show("Failed to load attachments.")});const r=n.bindList(`${s}/comments`);debugger;r.requestContexts().then(function(e){debugger;if(e.length>0){const t=e[0].getObject();const n=o.byId("commentInput");if(n){n.setValue(t.commentsText||"")}}else{console.log("No comments found for this leave request.")}}).catch(function(e){console.error("Failed to load comments:",e);sap.m.MessageToast.show("Failed to load comments.")})},openPreview:function(e){const t=e.getSource().getBindingContext("documents");const o=t.getObject();if(!o||!o.content){sap.m.MessageToast.show("No file content available.");return}const n=atob(o.content);const s=new Array(n.length);for(let e=0;e<n.length;e++){s[e]=n.charCodeAt(e)}const c=new Uint8Array(s);const a=new Blob([c],{type:o.mediaType});const r=URL.createObjectURL(a);window.open(r,"_blank")},onNavBack:function(){this.getOwnerComponent().getRouter().navTo("View1",{},true)}})});
//# sourceMappingURL=LeaveReqDetailed.controller.js.map